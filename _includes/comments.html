{% if site.Valine %}

<script src="//cdn.jsdelivr.net/npm/@waline/client"></script>
<div id="waline"></div>
<script>
    if ("{{site.img_id}}" == "1"){
        const img_name = "image";
        const img_url = "https://7bu.top/api/upload";
     }else if ("{{site.img_id}}" == "2"){
        const img_name = "smfile";
        const img_url = "https://sm.ms/api/v2/upload";
     }else{
        const img_name = "image";
        const img_url = "https://7bu.top/api/upload";
     };
    Waline({
        el: '#waline',
        serverURL: '{{site.serverURL}}',
        locale:{
            anonymous: '{{site.anonymous}}',
            placeholder: '{{site.placeholder}}'
        },
        uploadImage: function(file) {
            const formData = new FormData();
            formData.append( img_name, file);
            const token = "{{site.img_token}}";
            return fetch( img_url, {
                method: 'POST',
                body: formData,
                headers: { "Authorization": token}
            }).then(resp => resp.json()).then(resp => resp.data.url);
        },
        emoji: [
            'https://cdn.jsdelivr.net/gh/Small-tailqwq/WaLine-emoji@v1.1.1/%E8%9B%86%E9%9F%B3%E5%A8%98/',//蛆音娘
            'https://cdn.jsdelivr.net/gh/Small-tailqwq/WaLine-emoji@1.1.1/%E4%BD%90%E8%B4%BAAC%E5%A8%98/',//佐贺ac娘
            'https://cdn.jsdelivr.net/gh/Small-tailqwq/WaLine-emoji@1.1.1/%E5%A4%8F%E5%86%B0%E9%BA%BB%E9%BA%BB%E9%9B%BE%E9%9B%A8AC%E5%A8%98/',//夏冰麻麻雾雨AC娘
            'https://cdn.jsdelivr.net/gh/Small-tailqwq/WaLine-emoji@1.1.1/%E9%AD%94%E6%94%B9%E5%A8%98/',//魔改娘
            'https://cdn.jsdelivr.net/gh/Small-tailqwq/WaLine-emoji@1.1.1/%E5%BD%A9%E5%A8%98/',//彩娘
            'https://cdn.jsdelivr.net/gh/Small-tailqwq/WaLine-emoji@1.1.1/%E5%B0%91%E5%89%8D%E5%B0%8F%E5%89%A7%E5%9C%BA/',//少前小剧场
            'https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/weibo',
            'https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/bilibili',
        ],
    });
</script>
<style>
.v[data-class=v] .vcontent .vemoji {
    width: 3.5em !important;
}
.v[data-class=v] .vemoji-popup .vemoji {
    max-width: 2em !important;
    max-height: 3.5em !important;
}
</style>

{% endif %}
